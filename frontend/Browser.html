<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器相关原理 | 博客小站</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/assets/icon/favicon.ico">
    <meta name="description" content="Just write about feelings">
    
    <link rel="preload" href="/assets/css/0.styles.a4a23452.css" as="style"><link rel="preload" href="/assets/js/app.76fd0f98.js" as="script"><link rel="preload" href="/assets/js/1.d3b2eacc.js" as="script"><link rel="preload" href="/assets/js/2.af84dfee.js" as="script"><link rel="preload" href="/assets/js/3.6fb81e23.js" as="script"><link rel="preload" href="/assets/js/16.d856e5f4.js" as="script"><link rel="prefetch" href="/assets/js/10.38d06403.js"><link rel="prefetch" href="/assets/js/11.c350db38.js"><link rel="prefetch" href="/assets/js/12.1d462f45.js"><link rel="prefetch" href="/assets/js/13.8e670d8b.js"><link rel="prefetch" href="/assets/js/14.0d93bdb6.js"><link rel="prefetch" href="/assets/js/15.8580262d.js"><link rel="prefetch" href="/assets/js/17.7c8e15d9.js"><link rel="prefetch" href="/assets/js/18.b5f8c251.js"><link rel="prefetch" href="/assets/js/19.66afdda5.js"><link rel="prefetch" href="/assets/js/20.096693fd.js"><link rel="prefetch" href="/assets/js/21.02798515.js"><link rel="prefetch" href="/assets/js/22.eaf46649.js"><link rel="prefetch" href="/assets/js/23.ebeaed36.js"><link rel="prefetch" href="/assets/js/24.6c245452.js"><link rel="prefetch" href="/assets/js/5.8eb37b42.js"><link rel="prefetch" href="/assets/js/6.39ba5ed3.js"><link rel="prefetch" href="/assets/js/7.678e0678.js"><link rel="prefetch" href="/assets/js/8.c1e32ea0.js"><link rel="prefetch" href="/assets/js/9.2103df48.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a4a23452.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-052f55b9><div class="d-header" data-v-7119b065 data-v-052f55b9><div class="container" data-v-7119b065><div class="d-text-ani" data-v-3db5f0b1 data-v-7119b065><div class="stage" data-v-3db5f0b1><div class="wrapper" data-v-3db5f0b1><div class="slash" data-v-3db5f0b1></div> <div class="sides" data-v-3db5f0b1><div class="side" data-v-3db5f0b1></div> <div class="side" data-v-3db5f0b1></div> <div class="side" data-v-3db5f0b1></div> <div class="side" data-v-3db5f0b1></div></div> <div class="text" data-v-3db5f0b1><div class="text--backing" data-v-3db5f0b1>welcome</div> <div class="text--left" data-v-3db5f0b1><div class="inner" data-v-3db5f0b1>welcome</div></div> <div class="text--right" data-v-3db5f0b1><div class="inner" data-v-3db5f0b1>welcome</div></div></div></div></div></div> <div class="nav-container" data-v-7119b065><div class="nav-item" data-v-7119b065><a href="/" class="router-link-active" data-v-7119b065>首页</a></div><div id="nav_dropdown_前端笔记" class="nav-item nav-item-dropdown" data-v-7119b065><span data-v-7119b065>前端笔记</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-7119b065><path fill="currentColor" d="M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z" data-v-7119b065></path></svg> <div class="nav-item-options" style="display:none;" data-v-7119b065><p class="option-item" data-v-7119b065>JS</p><p class="option-item" data-v-7119b065>CSS</p><p class="option-item" data-v-7119b065>VUE</p></div></div></div> <div class="right-area" data-v-7119b065></div></div></div> <!----> <div class="d-wrapper" data-v-5c8e2a57 data-v-052f55b9><div class="content-wrapper" data-v-5c8e2a57><div class="d-article" data-v-607df124 data-v-052f55b9><div class="article-info" data-v-607df124><h1 data-v-607df124>浏览器相关原理</h1> <p class="time-container" data-v-607df124><i aria-hidden="true" class="fa fa-calendar" data-v-607df124></i> <span data-v-607df124>2020-08-09</span></p> <div class="d-article-info" data-v-71efe530 data-v-607df124><div class="categories" data-v-71efe530><div class="category-info" style="color:rgb(12, 176, 169);" data-v-71efe530><a href="/" class="router-link-active" data-v-71efe530><i aria-hidden="true" class="fa fa-folder-o" data-v-71efe530></i> <span data-v-71efe530>前端笔记</span></a></div><div class="category-info" style="color:rgb(17, 138, 178);" data-v-71efe530><a href="/" class="router-link-active" data-v-71efe530><i aria-hidden="true" class="fa fa-folder-o" data-v-71efe530></i> <span data-v-71efe530>浏览器</span></a></div></div> <div class="tags" data-v-71efe530><div class="tag-info" style="background:rgb(253, 138, 9, .1);border-color:rgb(253, 138, 9, .2);color:rgb(253, 138, 9);" data-v-71efe530>
            构建DOM
        </div><div class="tag-info" style="background:rgb(253, 138, 9, .1);border-color:rgb(253, 138, 9, .2);color:rgb(253, 138, 9);" data-v-71efe530>
            浏览器渲染
        </div></div></div></div> <div class="content__default" data-v-607df124><h2 id="构建dom"><a href="#构建dom" class="header-anchor">#</a> 构建DOM</h2> <p>解析HTML，添加节点到树中</p> <p><img src="http://p0.qhimg.com/t01e1ff266d0b355d62.gif" alt="img"></p> <p>图片和CSS这些资源一般不会阻塞HTML的解析，因为他们不会影响DOM的生成</p> <p>加载JS文件时阻塞：当浏览器构建 DOM 的时候，如果在 HTML 中遇到了一个 <code>&lt;script&gt;...&lt;/script&gt;</code>标签，它必须立即执行。如果脚本是来自于外部的，那么它必须首先下载脚本。</p> <p>原因：因为脚本可能改变DOM的结构，需要等脚本改变完再继续构建DOM，否则不安全</p> <p><img src="http://p0.qhimg.com/t01e3b5f9d1aaa24fea.gif" alt="img"></p> <p>CSS 可能会阻塞解析，取决于外部样式表和脚本在文档中的顺序。如果在文档中外部样式表放置在脚本之前，由于CSS解析与Script执行互斥，当解析器获取到一个 script 标签，DOM 将无法继续构建直到 JavaScript 执行完毕，而 JavaScript 在 CSS 下载完，解析完，并且 CSSOM 可以使用的时候，才能执行。</p> <p><img src="http://p0.qhimg.com/t011e23f55c658b7ba2.png" alt="img"></p> <p>最佳实践：样式放顶部，脚本放底部</p> <p>HTML是怎么转换成DOM树的：</p> <ol><li>编码</li> <li>预解析</li> <li>标记</li> <li>构建树</li></ol> <h2 id="cssom"><a href="#cssom" class="header-anchor">#</a> CSSOM</h2> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CSS_Object_Model" target="_blank" rel="noopener noreferrer">MDN上对CSSOM的描述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>The CSS Object Model is a set of APIs allowing the manipulation of CSS from JavaScript. It is much like the DOM, but for the CSS rather than the HTML. It allows users to read and modify CSS style dynamically.</p></blockquote> <p>CSSOM是一组允许JavaScript操作CSS的API，类似于DOM</p> <h2 id="浏览器渲染原理"><a href="#浏览器渲染原理" class="header-anchor">#</a> 浏览器渲染原理</h2> <p>浏览器渲染过程主要分五步：</p> <ul><li>将HTML文档解析为DOM树：
<ul><li>Tokeniser 标记化，将HTML内容解析为多个标记</li> <li>根据识别后的标记进行DOM树构造</li> <li>在构造过程中会创建document对象，然后在以document为根节点的树上进行各种元素的添加</li></ul></li> <li>主线程解析CSS，并确定每个DOM节点的计算样式，构建CSSOM</li> <li>将DOM和CSSOM合并为渲染树(rendering tree)，同时display:none的元素不在该树中，而在伪元素 <strong>::before</strong> , <strong>::after</strong> 中添加了content值的元素会被添加在该树</li> <li>layout布局（回流），即让浏览器弄清楚各个节点在页面的确切位置和大小</li> <li>调用GPU绘制、合成图层，显示在屏幕上</li></ul> <p>参考：<a href="https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/" target="_blank" rel="noopener noreferrer">浏览器的工作原理：新式网络浏览器幕后揭秘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <div class="d-prev-next" data-v-5c1060bc data-v-607df124><div class="prev" data-v-5c1060bc><!----></div> <div class="next" data-v-5c1060bc><a href="/frontend/CSS_Counter.html" data-v-5c1060bc><span data-v-5c1060bc>使用CSS为每个标题添加章节号</span> <i aria-hidden="true" class="fa fa-chevron-right" data-v-5c1060bc></i></a></div></div></div></div></div> <div class="d-catalogue" data-v-22ce3d1a data-v-052f55b9><div class="title" style="font-size:1rem;font-weight:700;text-indent:1.875rem;" data-v-22ce3d1a><span data-v-22ce3d1a>构建DOM</span></div><div class="title" style="font-size:1rem;font-weight:700;text-indent:1.875rem;" data-v-22ce3d1a><span data-v-22ce3d1a>CSSOM</span></div><div class="title" style="font-size:1rem;font-weight:700;text-indent:1.875rem;" data-v-22ce3d1a><span data-v-22ce3d1a>浏览器渲染原理</span></div> <div class="arrow" data-v-22ce3d1a><i class="fa fa-angle-double-right" data-v-22ce3d1a></i></div></div> <div class="d-to-top" data-v-4d53564f data-v-052f55b9><i aria-hidden="true" class="fa fa-chevron-up" data-v-4d53564f></i></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.76fd0f98.js" defer></script><script src="/assets/js/1.d3b2eacc.js" defer></script><script src="/assets/js/2.af84dfee.js" defer></script><script src="/assets/js/3.6fb81e23.js" defer></script><script src="/assets/js/16.d856e5f4.js" defer></script>
  </body>
</html>
